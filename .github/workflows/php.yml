name: PHP Composer

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

permissions:
  contents: read

jobs:
  php-tests:
            if: github.event.pull_request.draft == false
            runs-on: ubuntu-latest
            timeout-minutes: 10
        
            steps:
            - uses: actions/checkout@v4
        
            - name: Run PHP Tests in src directory
              uses: alleyinteractive/action-test-php@develop
              with:
                php-version: '8.1'
                working-directory: './src'
                cache-dependency-path: './src/composer.lock'
                audit-skip: 'true'
                test-command: 'composer run-script test:unit'
                build-command: 'composer run-script build:prod'

          
          
    # Add a test script to composer.json, for instance: "test": "vendor/bin/phpunit"
    # Docs: https://getcomposer.org/doc/articles/scripts.md

    # - name: Run test suite
    #   run: composer run-script test
